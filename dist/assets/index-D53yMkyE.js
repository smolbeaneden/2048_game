var p=Object.defineProperty;var y=(l,e,t)=>e in l?p(l,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):l[e]=t;var f=(l,e,t)=>y(l,typeof e!="symbol"?e+"":e,t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))o(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const d of s.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&o(d)}).observe(document,{childList:!0,subtree:!0});function t(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function o(i){if(i.ep)return;i.ep=!0;const s=t(i);fetch(i.href,s)}})();const b=(l,e)=>Math.floor(Math.random()*(e-l+1)+l),z=l=>{const e=l.length;if(e===0)return null;const t=b(0,e-1);return l[t]};let c=0;class S{constructor(){f(this,"board");f(this,"boardSize");f(this,"scoreElement");f(this,"showElement");f(this,"randomPoint");f(this,"boardMoved");this.showElement=document.getElementById("show"),this.scoreElement=document.getElementById("score"),this.boardSize=3,this.board=[],this.boardMoved=!0,this.disableKeys(),this.getDirection(),this.randomPoint={x:0,y:0};for(let e=0;e<=this.boardSize;e++){this.board[e]=[];for(let t=0;t<=this.boardSize;t++)this.board[e][t]=null}console.log(this.board)}getDirection(){document.onkeydown=i=>{switch(i.key){case"ArrowLeft":this.checkOver(),this.arrangeBlocks(0,0,this.boardSize,this.boardSize,"left"),this.boardMoved&&this.createPoint();break;case"ArrowRight":this.checkOver(),this.arrangeBlocks(0,this.boardSize,this.boardSize,0,"right"),this.boardMoved&&this.createPoint();break;case"ArrowUp":this.checkOver(),this.arrangeBlocks(0,0,this.boardSize,this.boardSize,"up"),this.boardMoved&&this.createPoint();break;case"ArrowDown":this.checkOver(),this.arrangeBlocks(this.boardSize,0,0,this.boardSize,"down"),this.boardMoved&&this.createPoint();break}};let e=null,t=null;function o(i){return i.touches}document.addEventListener("touchstart",i=>{const s=o(i)[0];e=s.clientX,t=s.clientY}),document.addEventListener("touchmove",i=>{if(!e||!t)return;let s=i.touches[0].clientX,d=i.touches[0].clientY,u=e-s,n=t-d;Math.abs(u)>Math.abs(n)?u>0?(this.checkOver(),this.arrangeBlocks(0,0,this.boardSize,this.boardSize,"left"),this.boardMoved&&this.createPoint()):(this.checkOver(),this.arrangeBlocks(0,this.boardSize,this.boardSize,0,"right"),this.boardMoved&&this.createPoint()):n>0?(this.checkOver(),this.arrangeBlocks(0,0,this.boardSize,this.boardSize,"up"),this.boardMoved&&this.createPoint()):(this.checkOver(),this.arrangeBlocks(this.boardSize,0,0,this.boardSize,"down"),this.boardMoved&&this.createPoint()),e=null,t=null})}getRandomEmptyPosition(){let e=1e3;for(;e>0;){let t=b(0,this.boardSize),o=b(0,this.boardSize);if(this.board[t][o]==null)return{x:t,y:o};e-=1}return this.disableKeys(),alert("Game over!"),{x:0,y:0}}checkOver(){let e=!0;for(let t=0;t<=this.boardSize;t++){let o=[],i=[];for(let s=0;s<=this.boardSize;s++)if(o.push(this.board[t][s]),i.push(this.board[s][t]),this.board[t][s]===null){e=!1;return}if(o[0]==o[1]||o[1]==o[2]||o[2]==o[3]){e=!1;break}if(i[0]==i[1]||i[1]==i[2]||i[2]==i[3]){e=!1;break}}e&&(this.disableKeys(),console.log("keys disabled"),alert("Game over!"))}show(){let e="";for(let t=0;t<=this.boardSize;t++)for(let o=0;o<=this.boardSize;o++)t==this.randomPoint.x&&o==this.randomPoint.y?(e+=`<div id='newCell'   style=' background-color:${m(this.board[t][o])};'>${this.board[t][o]??""}</div>`,console.log("yes")):e+=`<div id='cell' style=' background-color:${m(this.board[t][o])};'>${this.board[t][o]??""}</div>`;this.showElement.innerHTML=e,this.scoreElement.innerHTML="Score: "+c.toString()}disableKeys(){document.onkeydown=e=>{switch(e.key){}}}arrangeBlocks(e,t,o,i,s){let d=o,u=i;this.boardMoved=!1;let n=[];if(s=="left")for(let r=e;r<=d;r++){for(let a=t;a<=u;a++){let h=this.board[r][a];h!==null&&n.push(h)}this.setRowColumn(r,this.moveBlocks(n),"horizontal"),n=[]}if(s=="right")for(let r=e;r<=d;r++){for(let a=t;a>=u;a--){let h=this.board[r][a];h!==null&&n.push(h)}this.setRowColumn(r,this.moveBlocks(n).reverse(),"horizontal"),n=[]}if(s=="up")for(let r=t;r<=u;r++){for(let a=e;a<=d;a++){let h=this.board[a][r];h!==null&&n.push(h)}this.setRowColumn(r,this.moveBlocks(n),"vertical"),n=[]}if(s=="down")for(let r=t;r<=u;r++){for(let a=e;a>=d;a--){let h=this.board[a][r];h!==null&&n.push(h)}this.setRowColumn(r,this.moveBlocks(n).reverse(),"vertical"),n=[]}}moveBlocks(e){let t=e;return t.push(null,null,null,null),e[0]==e[1]&&e[0]!==null?(t=[2*e[0],e[2],e[3],null],c=c+2*e[0],e[2]==e[3]&&e[2]!==null&&(t=[2*e[0],2*e[2],null,null],c=c+2*e[2])):e[1]==e[2]&&e[1]!==null?(t=[e[0],2*e[1],e[3],null],c=c+2*e[1]):e[2]==e[3]&&e[2]!==null?(t=[e[0],e[1],2*e[2],null],c=c+2*e[2]):t=[e[0],e[1],e[2],e[3]],t}setRowColumn(e,t,o){if(console.log(t),console.log(this.board[e]),o=="horizontal"){console.log(this.board[e]);for(let i=0;i<=this.boardSize;i++)this.board[e][i]!==t[i]&&(this.boardMoved=!0),this.board[e][i]=t[i]}if(o=="vertical")for(let i=0;i<=this.boardSize;i++)this.board[i][e]!==t[i]&&(this.boardMoved=!0),this.board[i][e]=t[i]}createPoint(e=null){this.randomPoint=this.getRandomEmptyPosition();let t=e??z([2,2,2,2,4]);this.board[this.randomPoint.x][this.randomPoint.y]=t,console.log("showing,"),this.show()}}function g(){c=0,new S().createPoint(2)}var v;(v=document.getElementById("newGame"))==null||v.addEventListener("click",g);g();function m(l){return l==null?"#bacdb5":{2:"#bfddb9",4:"#99b194",8:"#afd5dd",16:"#84acb3",32:"#a0a3c6",64:"#dfae81",128:"#cccf8a",256:"#bd7987",512:"#45afb0",1024:"#ffc71c",2048:"#65bf69",4096:"#fe0c27"}[l]??"#2e2e2e"}
